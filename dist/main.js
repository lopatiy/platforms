!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.cc=this.canvas.getContext("2d")}return function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(t,[{key:"width",value:function(){return this.canvas.clientWidth}},{key:"height",value:function(){return this.canvas.clientHeight}},{key:"stroke",value:function(t){!t&&(t="nostroke"),this.cc.strokeStyle=t}},{key:"fill",value:function(t){!t&&(t="transparent"),this.cc.fillStyle=t}},{key:"clear",value:function(){this.cc.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"point",value:function(t,e){this.ellipse(t,e,1)}},{key:"ellipse",value:function(t,e,n){this.cc.beginPath(),this.cc.ellipse(t,e,n,n,0,0,2*Math.PI),this.cc.stroke()}},{key:"line",value:function(t,e,n,i){this.cc.beginPath(),this.cc.moveTo(t,e),this.cc.lineTo(n,i),this.cc.stroke()}},{key:"sprite",value:function(t,e,n){this.cc.putImageData(t,e,n)}},{key:"shape",value:function(t){this.cc.beginPath(),this.cc.moveTo(t[0].x,t[0].y);for(var e=1;e<t.length;e++)this.cc.lineTo(t[e].x,t[e].y);this.cc.closePath(),this.cc.fill(),this.cc.stroke()}}]),t}();function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.load(e,108,47,n)}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(t,[{key:"load",value:function(t,e,n,i){var r=this,o=document.createElement("img");o.onload=function(){var t=document.createElement("canvas");t.width=e,t.height=2*n,t.id="spritesCanvas",r.canvas=document.getElementById("spritesCanvas"),r.ctx=t.getContext("2d"),r.ctx.translate(e,0),r.ctx.scale(-1,1),r.ctx.drawImage(o,0,0,e,n),r.ctx.translate(e,0),r.ctx.scale(-1,1),r.ctx.drawImage(o,0,n,e,n),i(r.ctx.getImageData(0,0,e,n))},o.setAttribute("crossOrigin",""),o.src=t+"?"+(new Date).getTime()}},{key:"copy",value:function(){var t;return(t=this.ctx).getImageData.apply(t,arguments)}}]),t}();c(a,"spriteSheet",[[72,0,36,47],[0,47,36,47],[0,0,36,47],[72,47,36,47],[36,0,36,47],[36,47,36,47]]),c(a,"SPRITE",{IDLE:[a.spriteSheet[0],a.spriteSheet[1]],RUN:[[a.spriteSheet[2],a.spriteSheet[3]],[a.spriteSheet[4],a.spriteSheet[5]]]});var s=function(t,e){return[t[0]+e[0],t[1]+e[1]]};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function g(t,e,n){return e&&b(t.prototype,e),n&&b(t,n),t}var m,w=[0,.5],k=function(){function t(e,n){d(this,t),this.pos=[e,n],this.acc=[0,0],this.vel=[0,0]}return g(t,[{key:"update",value:function(){this.vel=s(this.vel,this.acc),this.pos=s(this.pos,this.vel)}}]),t}(),O=function(t){function e(t,n){var i;return d(this,e),(i=h(this,p(e).call(this,t,n))).dir=1,i.ground=n,i.sprite=a.SPRITE.IDLE[0],i}return y(e,k),g(e,[{key:"stop",value:function(){this.sprite=a.SPRITE.IDLE[0],this.vel[0]=0}},{key:"left",value:function(){this.dir=0,this.vel[0]=-3}},{key:"right",value:function(){this.dir=1,this.vel[0]=3}},{key:"duck",value:function(){}},{key:"jump",value:function(){this.isOnGround()?(this.applyJump(),this.doubleJumpAllowed=!0):this.doubleJumpAllowed&&(this.applyJump(),this.doubleJumpAllowed=!1)}},{key:"applyJump",value:function(){this.vel[1]=-6}},{key:"isOnGround",value:function(){return this.pos[1]>=this.ground}},{key:"update",value:function(){this.isOnGround()||(this.vel=s(this.vel,w)),f(p(e.prototype),"update",this).call(this),this.pos[1]>=this.ground&&(this.pos[1]=this.ground)}},{key:"render",value:function(t,e,n){var i;switch(!0){case Math.abs(this.vel[0])>0:i=a.SPRITE.RUN[Math.ceil(n%100/10)%2][this.dir];break;default:i=a.SPRITE.IDLE[this.dir]}this.isOnGround()||(i=a.SPRITE.IDLE[this.dir]);var r=this.pos[0]-i[2]/2,o=this.pos[1]-i[3],c=e.copy.apply(e,l(i));return t.sprite(c,r,o)}}]),e}(),S=function(t){function e(t,n){var i;return d(this,e),i=h(this,p(e).call(this,t,n)),document.addEventListener("keydown",function(t){switch(t.keyCode){case 37:i.left();break;case 39:i.right();break;case 38:i.jump();break;case 40:i.duck()}}),document.addEventListener("keyup",function(t){switch(t.keyCode){case 37:case 39:i.stop();break;case 38:i.duck();break;case 40:i.jump()}}),i}return y(e,O),e}();function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var j=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.h=document.body.scrollHeight,this.w=document.body.getBoundingClientRect().width,this.scene=new r(this.canvas),this.canvas.height=this.h,this.canvas.width=this.w,this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.w,this.h),this.ctx.fill(),this.scene.fill("black"),this.scene.stroke("black"),this.spritesManager=new a("../assets/hero.png",this.bootstrap.bind(this))}return function(t,e,n){e&&P(t.prototype,e),n&&P(t,n)}(t,[{key:"bootstrap",value:function(){var t=this;this.place();var e=1e3;this.render(e),this.scene.cc.putImageData(this.spritesManager.ctx.getImageData(0,0,this.w,this.h),0,0),setInterval(function(){return t.render(e++)},1e3/24)}},{key:"place",value:function(){m=new S(this.w/2,3*this.h/4)}},{key:"render",value:function(t){this.scene.clear(),this.scene.line(0,3*this.h/4,this.w,3*this.h/4),m.update(),m.render(this.scene,this.spritesManager,t)}}]),t}();window.app=new j}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjZW5lLmpzIiwid2VicGFjazovLy8uL3NyYy9zcHJpdGVzLmpzIiwid2VicGFjazovLy8uL3NyYy9mbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcG9pbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiU2NlbmUiLCJjYW52YXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiY2MiLCJnZXRDb250ZXh0IiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJjb2xvciIsInN0cm9rZVN0eWxlIiwiZmlsbFN0eWxlIiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJoZWlnaHQiLCJ4IiwieSIsImVsbGlwc2UiLCJiZWdpblBhdGgiLCJNYXRoIiwiUEkiLCJzdHJva2UiLCJ4MCIsInkwIiwieDEiLCJ5MSIsIm1vdmVUbyIsImxpbmVUbyIsInNwcml0ZSIsInB1dEltYWdlRGF0YSIsInBvaW50cyIsImxlbmd0aCIsImNsb3NlUGF0aCIsImZpbGwiLCJTcHJpdGVzTWFuYWdlciIsInVybCIsImNhbGxiYWNrIiwic3ByaXRlc19jbGFzc0NhbGxDaGVjayIsImxvYWQiLCJfdGhpcyIsImltYWdlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwib25sb2FkIiwiaWQiLCJnZXRFbGVtZW50QnlJZCIsImN0eCIsInRyYW5zbGF0ZSIsInNjYWxlIiwiZHJhd0ltYWdlIiwiZ2V0SW1hZ2VEYXRhIiwic2V0QXR0cmlidXRlIiwic3JjIiwiRGF0ZSIsImdldFRpbWUiLCJfdGhpcyRjdHgiLCJhcHBseSIsImFyZ3VtZW50cyIsIklETEUiLCJzcHJpdGVTaGVldCIsIlJVTiIsInN1bW0iLCJ2MSIsInYyIiwidW5pdCIsImdyYXZpdHkiLCJQb2ludCIsInBvaW50X2NsYXNzQ2FsbENoZWNrIiwicG9zIiwiYWNjIiwidmVsIiwicG9pbnRfY3JlYXRlQ2xhc3MiLCJVbml0IiwiX1BvaW50IiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJfZ2V0UHJvdG90eXBlT2YiLCJkaXIiLCJncm91bmQiLCJTUFJJVEUiLCJfaW5oZXJpdHMiLCJpc09uR3JvdW5kIiwiYXBwbHlKdW1wIiwiZG91YmxlSnVtcEFsbG93ZWQiLCJfZ2V0Iiwic2NlbmUiLCJzcHJpdGVzIiwidGltZSIsImFicyIsImNlaWwiLCJyZXN1bHQiLCJjb3B5IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiQ29udHJvbGxhYmxlVW5pdCIsIl9Vbml0IiwiX3RoaXMyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJrZXlDb2RlIiwibGVmdCIsInJpZ2h0IiwianVtcCIsImR1Y2siLCJzdG9wIiwiQXBwbGljYXRpb24iLCJzcmNfY2xhc3NDYWxsQ2hlY2siLCJoIiwiYm9keSIsInNjcm9sbEhlaWdodCIsInciLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJmaWxsUmVjdCIsInNwcml0ZXNNYW5hZ2VyIiwiYm9vdHN0cmFwIiwicGxhY2UiLCJyZW5kZXIiLCJzZXRJbnRlcnZhbCIsImNsZWFyIiwibGluZSIsInVwZGF0ZSIsIndpbmRvdyIsImFwcCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFG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ZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NlbmUge1xuICAgIGNvbnN0cnVjdG9yKGNhbnZhcykge1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgdGhpcy5jYyA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgfVxuXG4gICAgd2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5jbGllbnRXaWR0aFxuICAgIH07XG5cbiAgICBoZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHRcbiAgICB9O1xuXG4gICAgc3Ryb2tlKGNvbG9yKSB7XG4gICAgICAgICFjb2xvciAmJiAoY29sb3IgPSAnbm9zdHJva2UnKTtcbiAgICAgICAgdGhpcy5jYy5zdHJva2VTdHlsZSA9IGNvbG9yXG4gICAgfTtcblxuICAgIGZpbGwoY29sb3IpIHtcbiAgICAgICAgIWNvbG9yICYmIChjb2xvciA9ICd0cmFuc3BhcmVudCcpO1xuICAgICAgICB0aGlzLmNjLmZpbGxTdHlsZSA9IGNvbG9yXG4gICAgfTtcblxuICAgIGNsZWFyKCl7XG4gICAgICAgIHRoaXMuY2MuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuICAgIH1cblxuICAgIHBvaW50KHgsIHkpIHtcbiAgICAgICAgdGhpcy5lbGxpcHNlKHgsIHksIDEpXG4gICAgfTtcblxuICAgIGVsbGlwc2UoeCwgeSwgcikge1xuICAgICAgICB0aGlzLmNjLmJlZ2luUGF0aCgpO1xuICAgICAgICB0aGlzLmNjLmVsbGlwc2UoeCwgeSwgciwgciwgMCwgMCwgMiAqIE1hdGguUEkpO1xuICAgICAgICB0aGlzLmNjLnN0cm9rZSgpO1xuICAgIH07XG5cbiAgICBsaW5lKHgwLHkwLHgxLHkxKXtcbiAgICAgICAgdGhpcy5jYy5iZWdpblBhdGgoKTtcbiAgICAgICAgdGhpcy5jYy5tb3ZlVG8oeDAseTApO1xuICAgICAgICB0aGlzLmNjLmxpbmVUbyh4MSx5MSk7XG4gICAgICAgIHRoaXMuY2Muc3Ryb2tlKCk7XG4gICAgfVxuXG4gICAgc3ByaXRlKHNwcml0ZSwgeCwgeSl7XG4gICAgICAgIHRoaXMuY2MucHV0SW1hZ2VEYXRhKHNwcml0ZSwgeCwgeSk7XG4gICAgfVxuXG4gICAgc2hhcGUocG9pbnRzKSB7XG4gICAgICAgIHRoaXMuY2MuYmVnaW5QYXRoKCk7XG4gICAgICAgIHRoaXMuY2MubW92ZVRvKHBvaW50c1swXS54LCBwb2ludHNbMF0ueSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLmNjLmxpbmVUbyhwb2ludHNbaV0ueCwgcG9pbnRzW2ldLnkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2MuY2xvc2VQYXRoKCk7XG4gICAgICAgIHRoaXMuY2MuZmlsbCgpO1xuICAgICAgICB0aGlzLmNjLnN0cm9rZSgpO1xuICAgIH07XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTcHJpdGVzTWFuYWdlciB7XG5cdHN0YXRpYyBzcHJpdGVTaGVldCA9IFtcbiAgICAgICAgWzcyLCAwLCAzNiwgNDddLFxuICAgICAgICBbMCwgNDcsIDM2LCA0N10sXG5cblx0XHRbMCwgMCwgMzYsIDQ3XSwgLy9sZWZ0XG4gICAgICAgIFs3MiwgNDcsIDM2LCA0N10sIC8vcmlnaHRcblxuICAgICAgICBbMzYsIDAsIDM2LCA0N10sIC8vbGVmdFxuICAgICAgICBbMzYsIDQ3LCAzNiwgNDddLCAvL3JpZ2h0XG4gICAgXTtcblxuXHRzdGF0aWMgU1BSSVRFID0ge1xuXHRcdElETEUgOiBbXG4gICAgICAgICAgICBTcHJpdGVzTWFuYWdlci5zcHJpdGVTaGVldFswXSxcbiAgICAgICAgICAgIFNwcml0ZXNNYW5hZ2VyLnNwcml0ZVNoZWV0WzFdLFxuXHRcdF0sXG5cdFx0UlVOIDogW1xuICAgICAgICAgICAgW1Nwcml0ZXNNYW5hZ2VyLnNwcml0ZVNoZWV0WzJdLCBTcHJpdGVzTWFuYWdlci5zcHJpdGVTaGVldFszXV0sIC8vIGxlZnRcbiAgICAgICAgICAgIFtTcHJpdGVzTWFuYWdlci5zcHJpdGVTaGVldFs0XSwgU3ByaXRlc01hbmFnZXIuc3ByaXRlU2hlZXRbNV1dLCAvLyByaWdodFxuXHRcdF1cblx0fTtcblxuXHRjb25zdHJ1Y3Rvcih1cmwsIGNhbGxiYWNrKXtcblx0XHR0aGlzLmxvYWQodXJsLCAxMDgsIDQ3LCBjYWxsYmFjaylcblx0fVxuXG5cdGxvYWQodXJsLCB3aWR0aCwgaGVpZ2h0LCBjYWxsYmFjaykge1xuICAgXHRcdGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgXHRpbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgIFx0Y29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIFx0Y2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIFx0Y2FudmFzLmhlaWdodCA9IGhlaWdodCAqMjtcbiAgICAgICAgICAgIGNhbnZhcy5pZCA9ICdzcHJpdGVzQ2FudmFzJztcblxuICAgICAgICBcdHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nwcml0ZXNDYW52YXMnKTtcbiAgICAgICAgXHR0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBcdHRoaXMuY3R4LnRyYW5zbGF0ZSh3aWR0aCwgMCk7XG4gICAgICAgIFx0dGhpcy5jdHguc2NhbGUoLTEsMSk7XG4gICAgICAgIFx0dGhpcy5jdHguZHJhd0ltYWdlKGltYWdlLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuY3R4LnRyYW5zbGF0ZSh3aWR0aCwgMCk7XG4gICAgICAgICAgICB0aGlzLmN0eC5zY2FsZSgtMSwxKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgaGVpZ2h0LCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICBcdGNhbGxiYWNrKHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgaGVpZ2h0KSk7XG4gICAgXHR9O1xuXG4gICAgXHRpbWFnZS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJycpO1xuICAgIFx0aW1hZ2Uuc3JjID0gdXJsICsgJz8nICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdH1cblxuXHRjb3B5KC4uLmRhdGEpe1xuXHQgXHRyZXR1cm4gdGhpcy5jdHguZ2V0SW1hZ2VEYXRhKC4uLmRhdGEpO1xuXHR9XG59IiwiZXhwb3J0IGNvbnN0IHN1bW0gPSAodjEsdjIpID0+IHtcblx0cmV0dXJuIFt2MVswXSt2MlswXSwgdjFbMV0gKyB2MlsxXV07XG59XG5cbmV4cG9ydCBjb25zdCBzdWJ0ID0gKHYxLHYyKSA9PiB7XG5cdHJldHVybiBbdjFbMF0gLSB2MlswXSwgdjFbMV0gLSB2MlsxXV07XG59XG5cbmV4cG9ydCBjb25zdCBtdWx0ID0gKHYxLCBuMSwgbjIpID0+IHtcblx0cmV0dXJuIFt2MVswXSAqIG4xLCB2MVsxXSAqIChuMiA/IG4yIDogbjEpXTtcbn0iLCJpbXBvcnQge3N1bW0sIG11bHQsIHN1YnR9IGZyb20gXCIuL2ZuXCI7XG5pbXBvcnQgU3ByaXRlc01hbmFnZXIgZnJvbSBcIi4vc3ByaXRlc1wiO1xuXG5jb25zdCBncmF2aXR5ID0gWzAsIDAuNV07XG5jb25zdCBmID0gMztcblxuZXhwb3J0IGNsYXNzIFBvaW50IHtcblx0Y29uc3RydWN0b3IoeCx5KXtcblx0XHR0aGlzLnBvcyA9IFt4LHldO1xuXG5cdFx0dGhpcy5hY2MgPSBbMCwgMF07XG5cdFx0dGhpcy52ZWwgPSBbMCwgMF07XG5cdH1cblxuXHR1cGRhdGUoKXtcblx0XHR0aGlzLnZlbCA9IHN1bW0odGhpcy52ZWwsIHRoaXMuYWNjKTtcdFxuXHRcdHRoaXMucG9zID0gc3VtbSh0aGlzLnBvcywgdGhpcy52ZWwpO1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBVbml0IGV4dGVuZHMgUG9pbnQge1xuXHRjb25zdHJ1Y3Rvcih4LHkpe1xuXHRcdHN1cGVyKHgseSk7XG5cblx0XHR0aGlzLmRpciA9IDE7XG5cdFx0dGhpcy5ncm91bmQgPSB5O1xuXHRcdHRoaXMuc3ByaXRlID0gU3ByaXRlc01hbmFnZXIuU1BSSVRFLklETEVbMF07XG5cdH1cblxuXHRzdG9wKCl7XG5cdCAgICB0aGlzLnNwcml0ZSA9IFNwcml0ZXNNYW5hZ2VyLlNQUklURS5JRExFWzBdO1xuXHRcdHRoaXMudmVsWzBdID0gMDtcblx0fVxuXG5cdGxlZnQoKXtcblx0ICAgIHRoaXMuZGlyID0gMDtcblx0XHR0aGlzLnZlbFswXSA9IC0xICogZjtcblx0fVxuXG5cdHJpZ2h0KCl7XG4gICAgICAgIHRoaXMuZGlyID0gMTtcblx0XHR0aGlzLnZlbFswXSA9IDEgKiBmO1xuXHR9XG5cblx0ZHVjaygpe1xuXG5cdH1cblxuXHRqdW1wKCl7XG5cdFx0aWYodGhpcy5pc09uR3JvdW5kKCkpe1xuXHRcdFx0dGhpcy5hcHBseUp1bXAoKTtcblx0XHRcdHRoaXMuZG91YmxlSnVtcEFsbG93ZWQgPSB0cnVlO1xuXHRcdH0gZWxzZSBpZih0aGlzLmRvdWJsZUp1bXBBbGxvd2VkKSB7XG5cdFx0XHR0aGlzLmFwcGx5SnVtcCgpO1xuXHRcdFx0dGhpcy5kb3VibGVKdW1wQWxsb3dlZCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGFwcGx5SnVtcCgpe1xuXHRcdHRoaXMudmVsWzFdID0gLTIgKiBmXG5cdH1cblxuXHRpc09uR3JvdW5kKCl7XG5cdFx0cmV0dXJuIHRoaXMucG9zWzFdID49IHRoaXMuZ3JvdW5kO1xuXHR9XG5cblx0dXBkYXRlKCl7XG5cdFx0aWYoIXRoaXMuaXNPbkdyb3VuZCgpKXtcblx0XHRcdHRoaXMudmVsID0gc3VtbSh0aGlzLnZlbCwgZ3Jhdml0eSlcblx0XHR9XG5cblx0XHRzdXBlci51cGRhdGUoKTtcblx0XHRcblx0XHRpZih0aGlzLnBvc1sxXSA+PSB0aGlzLmdyb3VuZCl7XG5cdFx0XHR0aGlzLnBvc1sxXSA9IHRoaXMuZ3JvdW5kO1xuXHRcdH0gIFxuXHR9XG5cblx0cmVuZGVyKHNjZW5lLCBzcHJpdGVzLCB0aW1lKXtcblx0ICAgIGxldCBzcHJpdGU7XG5cblx0ICAgIHN3aXRjaCAodHJ1ZSl7XG4gICAgICAgICAgICBjYXNlIE1hdGguYWJzKHRoaXMudmVsWzBdKSA+IDAgOlxuICAgICAgICAgICAgICAgIHNwcml0ZSA9IFNwcml0ZXNNYW5hZ2VyLlNQUklURS5SVU5bTWF0aC5jZWlsKHRpbWUgJSAxMDAgLyAxMCkgJSAyXVt0aGlzLmRpcl07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHNwcml0ZSA9IFNwcml0ZXNNYW5hZ2VyLlNQUklURS5JRExFW3RoaXMuZGlyXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCF0aGlzLmlzT25Hcm91bmQoKSl7XG5cdCAgICAgICAgc3ByaXRlID0gU3ByaXRlc01hbmFnZXIuU1BSSVRFLklETEVbdGhpcy5kaXJdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeCA9IHRoaXMucG9zWzBdIC0gc3ByaXRlWzJdLzI7XG4gICAgICAgIGNvbnN0IHkgPSB0aGlzLnBvc1sxXSAtIHNwcml0ZVszXTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBzcHJpdGVzLmNvcHkoLi4uc3ByaXRlKTtcblxuXG5cdFx0cmV0dXJuIHNjZW5lLnNwcml0ZShyZXN1bHQsIHgsIHkpXG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnRyb2xsYWJsZVVuaXQgZXh0ZW5kcyBVbml0IHtcblx0Y29uc3RydWN0b3IoeCx5KXtcblx0XHRzdXBlcih4LHkpO1xuXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG5cdFx0XHRzd2l0Y2goZS5rZXlDb2RlKSB7XG5cdFx0XHRcdGNhc2UgMzc6IHRoaXMubGVmdCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAzOTogdGhpcy5yaWdodCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAzODogdGhpcy5qdW1wKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIDQwOiB0aGlzLmR1Y2soKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChlKSA9PiB7XG5cdFx0XHRzd2l0Y2goZS5rZXlDb2RlKSB7XG5cdFx0XHRcdGNhc2UgMzc6IFxuXHRcdFx0XHRjYXNlIDM5OiB0aGlzLnN0b3AoKTsgXG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIDM4OiB0aGlzLmR1Y2soKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgNDA6IHRoaXMuanVtcCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdH1cblx0XHR9KVxuXHR9XG59IiwiaW1wb3J0IFNjZW5lIGZyb20gXCIuL3NjZW5lXCI7XG5pbXBvcnQgU3ByaXRlc01hbmFnZXIgZnJvbSBcIi4vc3ByaXRlc1wiO1xuaW1wb3J0IHtDb250cm9sbGFibGVVbml0fSBmcm9tIFwiLi9wb2ludFwiO1xuXG5sZXQgdW5pdDtcbmxldCBpbnRlcnZhbDtcblxuY2xhc3MgQXBwbGljYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIik7XG4gICAgICAgIHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICB0aGlzLmggPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodDtcbiAgICAgICAgdGhpcy53ID0gZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcblxuICAgICAgICB0aGlzLnNjZW5lID0gbmV3IFNjZW5lKHRoaXMuY2FudmFzKTtcblxuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmg7XG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53O1xuXG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgdGhpcy5jdHguZmlsbFJlY3QoMCwwLCB0aGlzLncsIHRoaXMuaCk7XG4gICAgICAgIHRoaXMuY3R4LmZpbGwoKTtcblxuICAgICAgICB0aGlzLnNjZW5lLmZpbGwoJ2JsYWNrJyk7XG4gICAgICAgIHRoaXMuc2NlbmUuc3Ryb2tlKCdibGFjaycpO1xuXG4gICAgICAgIHRoaXMuc3ByaXRlc01hbmFnZXIgPSBuZXcgU3ByaXRlc01hbmFnZXIoXCIuLi9hc3NldHMvaGVyby5wbmdcIiwgdGhpcy5ib290c3RyYXAuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgYm9vdHN0cmFwKCkge1xuICAgICAgICB0aGlzLnBsYWNlKCk7XG4gICAgICAgIGxldCB0aW1lID0gMTAwMDtcbiAgICAgICAgdGhpcy5yZW5kZXIodGltZSk7XG4gICAgICAgIHRoaXMuc2NlbmUuY2MucHV0SW1hZ2VEYXRhKHRoaXMuc3ByaXRlc01hbmFnZXIuY3R4LmdldEltYWdlRGF0YSgwLDAsdGhpcy53LCB0aGlzLmgpLDAsMClcblxuICAgICAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXMucmVuZGVyKHRpbWUrKyksIDEwMDAvMjQpXG4gICAgfVxuXG4gICAgcGxhY2UoKXtcbiAgICAgICAgdW5pdCA9IG5ldyBDb250cm9sbGFibGVVbml0KHRoaXMudy8yLCAzKnRoaXMuaC80KTtcbiAgICB9XG5cbiAgICByZW5kZXIodGltZSl7XG4gICAgICAgIHRoaXMuc2NlbmUuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5zY2VuZS5saW5lKDAsIDMqdGhpcy5oLzQsIHRoaXMudywgMyp0aGlzLmgvNCk7XG4gICAgICAgIHVuaXQudXBkYXRlKCk7XG4gICAgICAgIHVuaXQucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuc3ByaXRlc01hbmFnZXIsIHRpbWUpO1xuICAgIH1cbn1cblxud2luZG93LmFwcCA9IG5ldyBBcHBsaWNhdGlvbigpOyJdLCJzb3VyY2VSb290IjoiIn0=